-- Q1: 1 ratio
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q2: 2 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q3: 3 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q4: 4 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q5: 5 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q6: 6 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q7: 7 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q8: 8 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q9: 9 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q10: 10 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q11: 11 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q12: 12 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q13: 13 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q14: 14 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q15: 15 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q16: 16 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q17: 17 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q18: 18 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q19: 19 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';

-- Q20: 20 ratios
SELECT CAST(pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_tax * l_tax), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * l_discount), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount) * (1 - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount - l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 + l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (1 - l_discount + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * l_discount * (1 + l_tax)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) + pac_noised(list_transform(list_zip(pac_sum_counters(hash(orders.o_custkey), l_extendedprice * (l_discount + l_tax) * (1 - l_discount)), pac_sum_counters(hash(orders.o_custkey), l_extendedprice)), lambda x: 100.0 * x[1] / x[2]), pac_keyhash(hash(orders.o_custkey))) AS DOUBLE) AS result
FROM lineitem JOIN orders ON l_orderkey = o_orderkey
WHERE l_shipdate <= DATE '1998-01-16';
